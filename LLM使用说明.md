# AI助手功能使用说明

## 功能概述

日历应用现已集成AI助手功能，支持接入各种LLM模型，包括您提供的API配置。

## 配置说明

### 基础URI设置
- **界面填写**：`https://api.hdgsb.com/v1`
- **实际请求**：`https://api.hdgsb.com/v1/chat/completions`
- **说明**：界面中只需填写基础URI，系统会自动拼接 `/chat/completions` 路径

### 配置参数
- **配置名称**：自定义名称，用于区分不同配置
- **基础URI**：API服务的基础地址
- **模型名称**：如 `qwen3-coder-480b-a35b-instruct`
- **API密钥**：您的API密钥，如 `sk-cgGZf8w2Aa9O3LjETVv`
- **温度系数**：控制AI回复的随机性（0.0-2.0）

## 使用步骤

### 1. 启动应用
```bash
python calendar_app.py
```

### 2. 打开AI助手
- 点击主界面右上角的 **"AI助手"** 按钮
- 弹出配置对话框，包含两个选项卡

### 3. 配置AI模型
在 **"配置管理"** 选项卡中：

#### 添加新配置
1. 点击 **"添加配置"** 按钮
2. 填写配置信息：
   - **配置名称**：如 "默认AI助手"
   - **基础URI**：`https://api.hdgsb.com/v1`
   - **模型名称**：`qwen3-coder-480b-a35b-instruct`
   - **API密钥**：您的API密钥
   - **温度系数**：建议0.7
   - **设为默认配置**：勾选此项
3. 点击 **"保存"** 按钮

#### 管理配置
- **编辑配置**：选择配置后点击"编辑配置"
- **删除配置**：选择配置后点击"删除配置"
- **设为默认**：选择配置后点击"设为默认"

### 4. 开始对话
在 **"AI聊天"** 选项卡中：

1. 在输入框中输入您的问题
2. 支持多行输入：
   - **Shift+Enter**：换行
   - **Enter**：发送消息
   - **Ctrl+Enter**：发送消息
3. 点击 **"发送"** 按钮或按Enter键发送
4. 点击 **"清空"** 按钮清空输入框
5. 等待AI回复
6. 继续对话


## 功能特点

### 界面设计
- **深色主题**：与主应用保持一致的黑色背景
- **选项卡设计**：配置管理和AI聊天分离
- **可调整大小**：支持拖拉框体，自由放大缩小窗口
- **聊天美化**：
  - 用户消息：蓝色背景 (#2d4a6b)
  - AI回复：绿色背景 (#2d6b4a)
  - 系统消息：灰色背景 (#4a4a4a)
- **流式显示**：AI回复实时流式显示，避免等待
- **字体优化**：用户消息加粗，AI回复正常，系统消息斜体
- **多行输入**：支持多行文本输入，Shift+Enter换行

### 错误处理
- **网络超时**：30秒超时设置
- **API错误**：显示详细的错误信息
- **配置验证**：确保所有必填字段完整

### 多线程处理
- **异步请求**：不会阻塞主界面
- **UI更新**：在主线程中安全更新界面

## 技术实现

### 数据库存储
- 使用SQLite数据库存储配置
- 支持多个配置管理
- 默认配置标记

### API调用
- 使用requests库发送HTTP请求
- 支持流式和非流式两种模式
- 自动回退机制：流式失败时自动使用非流式
- 完整的错误处理机制

### 界面组件
- 使用tkinter构建界面
- 自定义深色主题样式
- 响应式布局设计

## 故障排除

### 常见问题

1. **"请先配置AI模型"**
   - 解决：在配置管理中添加至少一个配置

2. **"API请求失败"**
   - 检查网络连接
   - 验证API密钥是否正确
   - 确认基础URI格式正确

3. **"请求超时"**
   - 检查网络连接
   - 尝试降低温度系数
   - 确认API服务可用

### 调试信息
- 查看控制台输出的错误信息
- 检查数据库中的配置是否正确
- 验证API密钥的有效性

## 安全注意事项

1. **API密钥保护**
   - 不要在公共场合显示API密钥
   - 定期更换API密钥
   - 不要将配置分享给他人

2. **网络安全**
   - 确保使用HTTPS协议
   - 避免在不安全的网络中使用

## 更新日志

- **v1.0**：初始版本，支持基本的AI对话功能
- 支持多配置管理
- 深色主题界面
- 完整的错误处理

---

**享受与AI助手的对话体验！** 🤖✨ 